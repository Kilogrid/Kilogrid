<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Kilogrid: src/kilob/kilob_wall_avoidance.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kilogrid
   </div>
   <div id="projectbrief">Kilogrid library documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('kilob__wall__avoidance_8h.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">kilob_wall_avoidance.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;kilolib.h&quot;</code><br />
<code>#include &quot;<a class="el" href="message_8h_source.html">message.h</a>&quot;</code><br />
</div>
<p><a href="kilob__wall__avoidance_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1c55d59a14d21c29eeac57ba2c22b0d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#a1c55d59a14d21c29eeac57ba2c22b0d7">WALL_READING_MEAN</a></td></tr>
<tr class="separator:a1c55d59a14d21c29eeac57ba2c22b0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8702fe59f487c92c727b23017a19921"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#af8702fe59f487c92c727b23017a19921">WALL_DEPTH</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:af8702fe59f487c92c727b23017a19921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b03c98ac9c7b303b26dcae6253fd1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#a55b03c98ac9c7b303b26dcae6253fd1e">WALL_READINGS_BUFFER_SIZE</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:a55b03c98ac9c7b303b26dcae6253fd1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the buffer to store LGAIN values of the signal sent by walls during wall avoidance. This buffer is used to compute an average power for the wall readings.  <a href="#a55b03c98ac9c7b303b26dcae6253fd1e">More...</a><br /></td></tr>
<tr class="separator:a55b03c98ac9c7b303b26dcae6253fd1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2f405d156a31aa874ef82cce818bd1e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#a2f405d156a31aa874ef82cce818bd1e8">kilob_wall_avoidance_init</a> ()</td></tr>
<tr class="separator:a2f405d156a31aa874ef82cce818bd1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd3eb0149f1b4925422afbd5f14092a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#a4dd3eb0149f1b4925422afbd5f14092a">kilob_on_wall_detected</a> (<a class="el" href="structdistance__measurement__t.html">distance_measurement_t</a> *, <a class="el" href="struct_i_r__message__t.html">IR_message_t</a> *)</td></tr>
<tr class="memdesc:a4dd3eb0149f1b4925422afbd5f14092a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a wall is detected. Sets the kilob_wa_wall_detected state variable and refreshes the kilob_wa_wall_detected_timeout.  <a href="#a4dd3eb0149f1b4925422afbd5f14092a">More...</a><br /></td></tr>
<tr class="separator:a4dd3eb0149f1b4925422afbd5f14092a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4fd3a6b4fbf9b90b7ae200a9feb9630"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#af4fd3a6b4fbf9b90b7ae200a9feb9630">kilob_wall_avoidance</a> ()</td></tr>
<tr class="memdesc:af4fd3a6b4fbf9b90b7ae200a9feb9630"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements wall avoidance for the kilobot. Should be called from the main loop() function.  <a href="#af4fd3a6b4fbf9b90b7ae200a9feb9630">More...</a><br /></td></tr>
<tr class="separator:af4fd3a6b4fbf9b90b7ae200a9feb9630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a492fdf6c0ef065ff013720513f69e8f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="kilob__wall__avoidance_8h.html#a492fdf6c0ef065ff013720513f69e8f4">kilob_wall_avoidance_reset</a> ()</td></tr>
<tr class="memdesc:a492fdf6c0ef065ff013720513f69e8f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the state to KILOB_WALL_AVOIDANCE_INIT. The rest of the initialization is done in <a class="el" href="kilob__wall__avoidance_8c.html#af4fd3a6b4fbf9b90b7ae200a9feb9630" title="Implements wall avoidance for the kilobot. Should be called from the main loop() function. ">kilob_wall_avoidance()</a>.  <a href="#a492fdf6c0ef065ff013720513f69e8f4">More...</a><br /></td></tr>
<tr class="separator:a492fdf6c0ef065ff013720513f69e8f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af8702fe59f487c92c727b23017a19921"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WALL_DEPTH&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8h_source.html#l00008">8</a> of file <a class="el" href="kilob__wall__avoidance_8h_source.html">kilob_wall_avoidance.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1c55d59a14d21c29eeac57ba2c22b0d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WALL_READING_MEAN</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8h_source.html#l00007">7</a> of file <a class="el" href="kilob__wall__avoidance_8h_source.html">kilob_wall_avoidance.h</a>.</p>

</div>
</div>
<a class="anchor" id="a55b03c98ac9c7b303b26dcae6253fd1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WALL_READINGS_BUFFER_SIZE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the buffer to store LGAIN values of the signal sent by walls during wall avoidance. This buffer is used to compute an average power for the wall readings. </p>

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8h_source.html#l00015">15</a> of file <a class="el" href="kilob__wall__avoidance_8h_source.html">kilob_wall_avoidance.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4dd3eb0149f1b4925422afbd5f14092a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kilob_on_wall_detected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdistance__measurement__t.html">distance_measurement_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_i_r__message__t.html">IR_message_t</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called when a wall is detected. Sets the kilob_wa_wall_detected state variable and refreshes the kilob_wa_wall_detected_timeout. </p>

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8c_source.html#l00123">123</a> of file <a class="el" href="kilob__wall__avoidance_8c_source.html">kilob_wall_avoidance.c</a>.</p>

</div>
</div>
<a class="anchor" id="af4fd3a6b4fbf9b90b7ae200a9feb9630"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t kilob_wall_avoidance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements wall avoidance for the kilobot. Should be called from the main loop() function. </p>
<p>The function first checks if any wall was detected in the last WA_WALL_DETECTED_TIMEOUT milliseconds. If not, it sets the kilob_wa_wall_detected state variable to false and wall avoidance is finished. The details of the states are as follows:</p>
<ul>
<li>KILOB_WALL_AVOIDANCE_INIT and any other state not detailed here: This is the entry state, it initializes a timeout and a direction to turn the kilobot. The next state is KILOB_WALL_AVOIDANCE_ROTATION.</li>
<li>KILOB_WALL_AVOIDANCE_ROTATION: The kilobot rotates in this state until the timeout is reached. It sets the next timeout for escaping from the wall, starts the movement straight and goes to the state KILOB_WALL_AVOIDANCE_ESCAPE.</li>
<li>KILOB_WALL_AVOIDANCE_ESCAPE: Waits for the timeout and goes back to the KILOB_WALL_AVOIDANCE_INIT for reinitalization.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>true if the wall avoidance is still running, false if the wall was avoided. </dd></dl>

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8c_source.html#l00163">163</a> of file <a class="el" href="kilob__wall__avoidance_8c_source.html">kilob_wall_avoidance.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2f405d156a31aa874ef82cce818bd1e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kilob_wall_avoidance_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8c_source.html#l00080">80</a> of file <a class="el" href="kilob__wall__avoidance_8c_source.html">kilob_wall_avoidance.c</a>.</p>

</div>
</div>
<a class="anchor" id="a492fdf6c0ef065ff013720513f69e8f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kilob_wall_avoidance_reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the state to KILOB_WALL_AVOIDANCE_INIT. The rest of the initialization is done in <a class="el" href="kilob__wall__avoidance_8c.html#af4fd3a6b4fbf9b90b7ae200a9feb9630" title="Implements wall avoidance for the kilobot. Should be called from the main loop() function. ">kilob_wall_avoidance()</a>. </p>

<p>Definition at line <a class="el" href="kilob__wall__avoidance_8c_source.html#l00275">275</a> of file <a class="el" href="kilob__wall__avoidance_8c_source.html">kilob_wall_avoidance.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
